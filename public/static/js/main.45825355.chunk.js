(this["webpackJsonpmesto-react"]=this["webpackJsonpmesto-react"]||[]).push([[0],{20:function(e,t,a){},23:function(e,t,a){e.exports=a.p+"static/media/Vector.c6f11019.svg"},26:function(e,t,a){e.exports=a(36)},36:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),i=a(22),o=a.n(i),c=(a(20),a(25)),l=a(1),u=a(15),s=a(2),p=a(23),m=a.n(p);var d=function(){return r.a.createElement("header",{className:"header"},r.a.createElement("img",{className:"header__logo",src:m.a,alt:"\u041b\u043e\u0433\u043e\u0442\u0438\u043f"}))},_=r.a.createContext();var f=function(e){var t=e.onCardClick,a=e.onCardLike,n=e.onCardDelete,i=e.card,o=i.name,c=void 0===o?"":o,u=i.link,s=void 0===u?"":u,p=i.likes,m=void 0===p?[]:p,d=r.a.useContext(_),f=i.owner._id===d._id,b=r.a.useState(!1),E=Object(l.a)(b,2),v=E[0],h=E[1],g="card__delete-button ".concat(f?"card__delete-button_visible":"card__delete-button_hidden"),N=m.some((function(e){return e._id===d._id})),y="card__like ".concat(N?"card__like_active":null),C="card__like-counter ".concat(v?"card__like-counter_animation":null);return r.a.createElement("li",{className:"card"},r.a.createElement("img",{className:"card__photo",alt:c,src:s,onClick:function(){t(i)}}),r.a.createElement("button",{className:g,onClick:function(){n(i)}}),r.a.createElement("div",{className:"card__info-container"},r.a.createElement("h2",{className:"card__title"},c),r.a.createElement("div",{className:"card__like-container"},r.a.createElement("button",{className:y,onClick:function(){h(!0),setTimeout((function(){h(!1)}),500),a(i)},type:"button"}),r.a.createElement("p",{className:C},m.length))))};var b=function(e){var t=e.cards,a=e.cardClick,n=e.onAddPlace,i=e.onEditProfile,o=e.onEditAvatar,c=e.onCardLike,l=e.onDeletePopup,u=r.a.useContext(_),s=u.name,p=u.about,m=u.avatar;return r.a.createElement("main",{className:"content"},r.a.createElement("section",{className:"profile"},r.a.createElement("div",{className:"profile__wrap"},r.a.createElement("div",{className:"profile__avatar",onClick:o},r.a.createElement("img",{className:"profile__avatar-image",alt:"\u0410\u0432\u0430\u0442\u0430\u0440",src:m})),r.a.createElement("div",{className:"profile__info"},r.a.createElement("div",{className:"profile__text-container"},r.a.createElement("h2",{className:"profile__title"},s),r.a.createElement("button",{className:"profile__edit-button",type:"button",onClick:i})),r.a.createElement("p",{className:"profile__subtitle"},p))),r.a.createElement("button",{className:"profile__add-button",type:"button",onClick:n})),r.a.createElement("ul",{className:"cards"},t.map((function(e){return r.a.createElement(f,{card:e,key:e._id,onCardClick:a,onCardLike:c,onCardDelete:l})}))))};var E=function(){return r.a.createElement("footer",{className:"footer"},r.a.createElement("p",{className:"footer__title"},"\xa9 2020 Mesto Russia"))};var v=function(e){var t=e.card,a=e.card,n=(a=void 0===a?{link:"",name:""}:a).link,i=a.name,o=e.onClose;return r.a.createElement("div",{className:"popup popup_type_image ".concat(t?"popup_opened":null)},r.a.createElement("figure",{className:"popup__image-container"},r.a.createElement("button",{className:"popup__button-close",type:"button",onClick:o}),r.a.createElement("img",{className:"popup__photo",src:n,alt:i}),r.a.createElement("figcaption",{className:"popup__caption"},i)),r.a.createElement("div",{className:"popup__overlay popup__overlay_image",onClick:o}))};var h=function(e){var t=e.buttonTitle,a=e.children,n=e.name,i=e.title,o=e.onClose,c=e.isOpen,l=e.onSubmit,u=e.isDisabled,s=e.renderSubmitAnimation;return r.a.createElement("div",{className:"popup popup_type_".concat(n," ").concat(c?"popup_opened":null)},r.a.createElement("div",{className:"popup__container"},r.a.createElement("h2",{className:"popup__title"},i),r.a.createElement("button",{className:"popup__button-close",onClick:o,type:"button"}),r.a.createElement("form",{className:"popup__form",name:n,onSubmit:l},a,r.a.createElement("button",{className:"popup__button-submit popup__button-submit_action \n                    ".concat(s?"popup__button-submit_loading":null,"\n                    ").concat(u?null:"popup__button-submit_disabled"),type:"submit"},t))),r.a.createElement("div",{className:"popup__overlay",onClick:o}))},g=a(9),N=a(8),y=function(e,t,a){var n=t.field,r=t.type,i=t.value;switch(r){case"DISPATCH":var o=Object(N.a)(Object(N.a)({},e.inputValues),{},Object(g.a)({},n,i.value)),c=Object(N.a)(Object(N.a)({},e.inputValidities),{},Object(g.a)({},"".concat(n,"Validity"),i.validity.valid)),l=Object(N.a)(Object(N.a)({},e.inputErrors),{},Object(g.a)({},"".concat(n,"Error"),i.validationMessage)),u=!0;for(var s in c){var p=s.replace("Validity","");u=u&&c[s]&&o[p]}return{inputValidities:c,inputErrors:l,formValid:u,inputValues:o};case"RESET":return a}},C={inputValues:{name:"",about:""},inputValidities:{nameValidity:!0,aboutValidity:!0},inputErrors:{nameError:"",aboutError:""},formValid:!1};function k(e,t){return Object.assign(C.inputValues,t.currentUser),y(e,t,C)}var O=function(e){var t=e.isOpen,a=e.onClose,n=e.onUpdateUser,i=e.isSubmitting,o=r.a.useContext(_),c=r.a.useReducer(k,C),u=Object(l.a)(c,2),s=u[0],p=u[1],m=s.inputValidities,d=m.nameValidity,f=m.aboutValidity,b=s.inputErrors,E=b.nameError,v=b.aboutError,g=s.inputValues,N=g.name,y=g.about,O=s.formValid,S=function(e){p({type:"DISPATCH",field:e.target.name,value:e.target,currentUser:o})};return r.a.useEffect((function(){p({type:"RESET",currentUser:o})}),[t,o]),r.a.createElement(h,{name:"edit-profile",title:"\u0420\u0435\u0434\u0430\u043a\u0442\u0438\u0440\u043e\u0432\u0430\u0442\u044c \u041f\u0440\u043e\u0444\u0438\u043b\u044c",buttonTitle:"C\u043e\u0445\u0440\u0430\u043d\u0438\u0442\u044c",isOpen:t,onClose:a,onSubmit:function(e){e.preventDefault(),n({name:N,about:y}),e.target.reset()},renderSubmitAnimation:i,isDisabled:O},r.a.createElement("label",{className:"popup__form-label"},r.a.createElement("input",{className:"popup__input ".concat(d?null:"popup__input_type_error"),id:"title",name:"name",type:"text",placeholder:"\u0424\u0418\u041e",minLength:"2",maxLength:"20",pattern:"[a-zA-Z\u0410-\u042f\u0401\u0430-\u044f\u0451\\s\\-]+",required:!0,value:N,onChange:function(e){S(e)}}),r.a.createElement("span",{className:"popup__input-error",id:"input-title-error"},E)),r.a.createElement("label",{className:"popup__form-label"},r.a.createElement("input",{className:"popup__input ".concat(f?null:"popup__input_type_error"),id:"subtitle",name:"about",type:"text",placeholder:"\u041f\u0440\u043e\u0444\u0435\u0441\u0441\u0438\u044f",minLength:"2",maxLength:"200",pattern:"^[^\\s\\-].+[^\\s']$",value:y,onChange:function(e){S(e)},required:!0}),r.a.createElement("span",{className:"popup__input-error",id:"input-subtitle-error"},v)))};var S=function(e){var t=e.isOpen,a=e.onClose,n=e.onUpdateAvatar,i=e.isSubmitting,o=r.a.useRef(),c=r.a.useState(!0),u=Object(l.a)(c,2),s=u[0],p=u[1],m=r.a.useState(!1),d=Object(l.a)(m,2),_=d[0],f=d[1],b=r.a.useState(""),E=Object(l.a)(b,2),v=E[0],g=E[1];return r.a.useEffect((function(){p(!0),f(!1),g(""),o.current.value=""}),[t]),r.a.createElement(h,{name:"edit-avatar",title:"\u041e\u0431\u043d\u043e\u0432\u0438\u0442\u044c \u0410\u0432\u0430\u0442\u0430\u0440",buttonTitle:"\u0421\u043e\u0445\u0440\u0430\u043d\u0438\u0442\u044c",isOpen:t,onClose:a,onSubmit:function(e){!function(e){e.preventDefault(),n({avatar:o.current.value}),e.target.reset()}(e)},renderSubmitAnimation:i,isDisabled:_},r.a.createElement("label",{className:"popup__form-label"},r.a.createElement("input",{ref:o,className:"popup__input ".concat(s?null:"popup__input_type_error"),id:"input-title",name:"avatar",type:"url",placeholder:"\u0421\u0441\u044b\u043b\u043a\u0430 \u043d\u0430 \u043a\u0430\u0440\u0442\u0438\u043d\u043a\u0443",required:!0,onChange:function(){var e=o.current,t=e.validity,a=e.validationMessage;p(t.valid),g(a),f(t.valid)}}),r.a.createElement("span",{className:"popup__input-error",id:"input-title-error"},v)))},j={inputValues:{name:"",link:""},inputValidities:{nameValidity:!0,linkValidity:!0},inputErrors:{nameError:"",linkError:""},formValid:!1},D=function(e,t){return y(e,t,j)};var V=function(e){var t=e.isOpen,a=e.onClose,n=e.onAddPlace,i=e.isSubmitting,o=r.a.useReducer(D,j),c=Object(l.a)(o,2),u=c[0],s=c[1],p=u.inputValues,m=p.name,d=p.link,_=u.formValid,f=u.inputValidities,b=f.nameValidity,E=f.linkValidity,v=u.inputErrors,g=v.nameError,N=v.linkError,y=function(e){s({type:"DISPATCH",field:e.target.name,value:e.target})};return r.a.useEffect((function(){s({type:"RESET"})}),[t]),r.a.createElement(h,{name:"add-card",title:"\u041d\u043e\u0432\u043e\u0435 \u041c\u0435\u0441\u0442\u043e",buttonTitle:"\u0421\u043e\u0437\u0434\u0430\u0442\u044c",isOpen:t,onClose:a,onSubmit:function(e){e.preventDefault(),n({name:m,link:d}),e.target.reset()},renderSubmitAnimation:i,isDisabled:_},r.a.createElement("label",{className:"popup__form-label"},r.a.createElement("input",{className:"popup__input ".concat(b?null:"popup__input_type_error"),id:"input-title",name:"name",type:"text",placeholder:"\u041d\u0430\u0437\u0432\u0430\u043d\u0438\u0435",minLength:"2",maxLength:"30",required:!0,value:m,onChange:y}),r.a.createElement("span",{className:"popup__input-error",id:"input-title-error"},g)),r.a.createElement("label",{className:"popup__form-label"},r.a.createElement("input",{className:"popup__input ".concat(E?null:"popup__input_type_error"),id:"input-subtitle",name:"link",type:"url",placeholder:"\u0421\u0441\u044b\u043b\u043a\u0430 \u043d\u0430 \u043a\u0430\u0440\u0442\u0438\u043d\u043a\u0443",required:!0,value:d,onChange:y}),r.a.createElement("span",{className:"popup__input-error",id:"input-subtitle-error"},N)))};var w=function(e){var t=e.isOpen,a=e.onClose,n=e.onDeleteSubmit,i=e.card,o=e.isSubmitting;return r.a.createElement(h,{name:"popup-delete",title:"\u0412\u044b \u0443\u0432\u0435\u0440\u0435\u043d\u044b?",buttonTitle:"\u0414\u0430",isOpen:t,onClose:a,onSubmit:function(e){e.preventDefault(),n(i)},renderSubmitAnimation:o,isDisabled:!0})};var A=function(){return r.a.createElement("div",{className:"spinner"},"Loading...")},U=a(13),P=a(14),T="users/me/",L="cards/",x="avatar",I="likes/",R=new(function(){function e(t){var a=t.baseUrl;Object(U.a)(this,e),this._url=a}return Object(P.a)(e,[{key:"fetchData",value:function(){return fetch("".concat(this._url)).then((function(e){return e.ok?e.json():Promise.reject(new Error("\u041e\u0448\u0438\u0431\u043a\u0430: ".concat(e.status)))}))}}]),e}())({baseUrl:"https://api.giphy.com/v1/gifs/random?tag=dogs&rating=g&api_key=xZXsHMfcYYAZ8rEhdSEGmIGqudaSbeg7"});var q=function(){var e=r.a.useState(""),t=Object(l.a)(e,2),a=t[0],n=t[1],i=function(){R.fetchData().then((function(e){n(e.data.embed_url)})).catch((function(e){console.log(e)}))};return r.a.useEffect((function(){i()}),[]),r.a.createElement("div",{className:"page404"},r.a.createElement("h1",{className:"page404__title"},"404"),r.a.createElement("p",{className:"page404__subtitle"},"\u0417\u0434\u0435\u0441\u044c \u043c\u043e\u0436\u043d\u043e \u043d\u0435\u043c\u043d\u043e\u0433\u043e \u043e\u0442\u0434\u043e\u0445\u043d\u0443\u0442\u044c"),r.a.createElement("div",{className:"page404__coub-wrap"},r.a.createElement("iframe",{className:"page404__gif",title:"random gif",src:a,allowFullScreen:!0})),r.a.createElement("div",{className:"page404__button-container"},r.a.createElement(u.b,{to:"/",className:"page404__button"},"\u0412\u0435\u0440\u043d\u0443\u0442\u044c\u0441\u044f \u043d\u0430 Mesto"),r.a.createElement("button",{className:"page404__button",onClick:i},"\u041f\u043e\u0437\u0430\u043b\u0438\u043f\u0430\u0442\u044c \u043d\u0430 \u0441\u043e\u0431\u0430\u0447\u0435\u043a")))},H=new(function(){function e(t){var a=t.baseUrl,n=t.headers;Object(U.a)(this,e),this._url=a,this._headers=n}return Object(P.a)(e,[{key:"_fetchData",value:function(e,t){return fetch("".concat(this._url).concat(e),t).then((function(e){return e.ok?e.json():Promise.reject(new Error("\u041e\u0448\u0438\u0431\u043a\u0430: ".concat(e.status)))}))}},{key:"getUserInfo",value:function(){return this._fetchData(T,{headers:this._headers})}},{key:"updateUserInfo",value:function(e){return this._fetchData(T,{headers:this._headers,method:"PATCH",body:JSON.stringify(e)})}},{key:"updateUserAvatar",value:function(e){return this._fetchData("".concat(T).concat(x),{headers:this._headers,method:"PATCH",body:JSON.stringify(e)})}},{key:"getInitialCards",value:function(){return this._fetchData(L,{headers:this._headers})}},{key:"postNewCard",value:function(e){return this._fetchData(L,{headers:this._headers,method:"POST",body:JSON.stringify(e)})}},{key:"deleteCard",value:function(e){return this._fetchData("".concat(L).concat(e),{method:"DELETE",headers:this._headers})}},{key:"setLike",value:function(e,t){var a;return a=t?"DELETE":"PUT",this._fetchData("".concat(L).concat(I).concat(e),{method:a,headers:this._headers})}}]),e}())({baseUrl:"https://mesto.nomoreparties.co/v1/cohort-12/",headers:{authorization:"d2854785-f942-4a21-9d80-03fbc6fb281b","Content-Type":"application/json"}});var M=function(){var e=r.a.useState({name:"",avatar:"",about:"",_id:""}),t=Object(l.a)(e,2),a=t[0],i=t[1],o=r.a.useState([]),p=Object(l.a)(o,2),m=p[0],f=p[1],h=r.a.useState(!1),g=Object(l.a)(h,2),N=g[0],y=g[1],C=r.a.useState(!1),k=Object(l.a)(C,2),j=k[0],D=k[1],U=r.a.useState(!1),P=Object(l.a)(U,2),T=P[0],L=P[1],x=r.a.useState(!1),I=Object(l.a)(x,2),R=I[0],M=I[1],J=r.a.useState(!1),Z=Object(l.a)(J,2),z=Z[0],B=Z[1],G=r.a.useState(!1),W=Object(l.a)(G,2),Y=W[0],$=W[1],F=r.a.useState(void 0),X=Object(l.a)(F,2),K=X[0],Q=X[1],ee=r.a.useState(void 0),te=Object(l.a)(ee,2),ae=te[0],ne=te[1],re=Object(n.useCallback)((function(e){"Escape"===e.key&&oe()}),[]),ie=[T,R,z,Y,K];r.a.useEffect((function(){ie.some((function(e){return!0===e||"object"===typeof e}))?window.addEventListener("keyup",re):window.removeEventListener("keyup",re)}),[re,ie]),r.a.useEffect((function(){D(!0),Promise.all([H.getUserInfo(),H.getInitialCards()]).then((function(e){var t=Object(l.a)(e,2),a=t[0],n=t[1];i(a),f(n),D(!1)})).catch((function(e){console.log(e)}))}),[]);var oe=function(){M(!1),B(!1),L(!1),Q(void 0),$(!1)},ce=function(e){y(!0),H.deleteCard(e._id).then((function(){var t=m.filter((function(t){return t._id!==e._id}));f(t),oe(),y(!1)})).catch((function(e){console.log(e)}))};return r.a.createElement(u.a,null,r.a.createElement(_.Provider,{value:a},r.a.createElement("div",{className:"page"},r.a.createElement(d,null),r.a.createElement(s.c,null,r.a.createElement(s.a,{exact:!0,path:"/"},j?r.a.createElement(A,null):r.a.createElement(b,{onAddPlace:function(){M(!0)},onEditProfile:function(){L(!0)},onEditAvatar:function(){B(!0)},cardClick:function(e){Q(e)},cards:m,onCardDelete:ce,onCardLike:function(e){var t=e.likes.some((function(e){return e._id===a._id}));H.setLike(e._id,t).then((function(t){var a=m.map((function(a){return a._id===e._id?t:a}));f(a)})).catch((function(e){console.log(e)}))},onDeletePopup:function(e){$(!0),ne(e)}})),r.a.createElement(s.a,{path:"*"},r.a.createElement(q,null))),r.a.createElement(E,null),r.a.createElement(w,{isOpen:Y,onClose:oe,onDeleteSubmit:ce,card:ae,isSubmitting:N}),r.a.createElement(O,{isOpen:T,onClose:oe,onUpdateUser:function(e){y(!0),H.updateUserInfo(e).then((function(e){i(e),oe(),y(!1)})).catch((function(e){console.log(e)}))},isSubmitting:N}),r.a.createElement(S,{isOpen:z,onClose:oe,onUpdateAvatar:function(e){y(!0),H.updateUserAvatar(e).then((function(e){i(e),oe(),y(!1)})).catch((function(e){console.log(e)}))},isSubmitting:N}),r.a.createElement(V,{isOpen:R,onClose:oe,onAddPlace:function(e){y(!0),H.postNewCard(e).then((function(e){f([e].concat(Object(c.a)(m))),oe(),y(!1)})).catch((function(e){console.log(e)}))},isSubmitting:N}),r.a.createElement(v,{card:K,onClose:oe}))))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));o.a.render(r.a.createElement(r.a.StrictMode,null,r.a.createElement(M,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[26,1,2]]]);
//# sourceMappingURL=main.45825355.chunk.js.map